# ファミリープラン家族共有機能設計書

## 1. 概要
ファミリープラン契約者向けに、家族間でアカウントを共有できる機能を実装する。  
本機能により、ファミリープランの管理者が他のユーザー（家族）を招待し、グループ全員がファミリープランの特典を利用できるようにする。  
また、Googleアカウントログインが必須であることを活かし、Googleアカウント情報を利用したQRコード招待機能を追加し、家族メンバーの追加をより簡単・安全に行えるようにする。

## 2. 目的
- ファミリープラン契約者が家族を招待し、グループ全員でプレミアム機能を利用可能にする。
- 家族間でリストやタブの共有・送信を可能にし、共同での利用体験を向上させる。
- Googleアカウントを利用したQRコード招待により、招待プロセスの利便性とセキュリティを向上させる。

## 3. 機能要件

### 3.1. アカウント招待・登録
- ファミリープラン管理者（親アカウント）は、家族（子アカウント）を招待できる。
- 招待方法として、従来の招待リンク送信に加え、Googleアカウント情報を含んだQRコードを生成して表示できる。
- 招待されたユーザーは、アプリ内の「QRコード読み取り」機能を使ってQRコードを読み取ることで、Googleアカウントでログインした状態でファミリーグループへの参加申請ができる。
- 招待されたユーザーは、承認後ファミリーグループに参加する。
- グループに参加した全アカウントにファミリープランの権利が付与される。

### 3.2. ファミリープラン権利の付与
- ファミリーグループに所属する全アカウントは、ファミリープランの特典（例：リスト数上限の拡大、広告非表示等）を享受できる。

### 3.3. リスト・タブの共有
- ファミリーグループ内のユーザー同士で、リストやタブを共有・送信できる。
- 共有されたリストやタブは、グループ全員が閲覧・編集可能。

### 3.4. Googleアカウントを利用したQRコードによるメンバー追加
- 管理者は、アプリ内でファミリーグループ招待用のQRコードを生成・表示できる。このQRコードには、管理者のGoogleアカウントIDやグループID、招待トークン等が含まれる。
- 招待される側は、アプリ内のQRコードリーダー機能でQRコードを読み取ることで、自身のGoogleアカウントでログインした状態でグループ参加申請ができる。
- QRコードには有効期限や一度限りの利用制限を設け、不正利用やセキュリティリスクを低減する。
- 参加申請時、Googleアカウントの認証情報をサーバー側で検証し、なりすましや不正参加を防止する。

## 4. 非機能要件
- 招待・参加・共有・QRコード操作は、他のページ（例：設定画面やサブスクリプション画面）のUI/UXを参考にし、統一感のあるデザイン・操作性とする。
- ボタンやダイアログ、リスト表示、QRコード表示・読み取りなどのUIコンポーネントは既存画面と同様のスタイル・配色・アイコンを用いる。
- 操作フロー（招待→QRコード生成→読み取り→Googleアカウント認証→承認→参加→共有）は、既存のユーザー体験に沿った直感的な導線とする。
- セキュリティ・プライバシーに配慮し、グループ外への情報漏洩を防止する。
- QRコードの内容は暗号化し、第三者による不正参加を防ぐ。
- Googleアカウントの認証情報は、サーバー側で厳格に検証し、本人確認を徹底する。

## 5. 参考
- YouTubeプレミアムのファミリー共有機能や、LINEグループ招待のQRコード機能を参考に設計する。
- 本アプリ内の既存ページ（設定画面、サブスクリプション画面等）のUI/UXを参考に、統一感を重視する。
